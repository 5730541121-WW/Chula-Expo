<!-- Libery -->
<link rel="import" href="/public/lib/polymer/polymer.html">
<!-- Icon Component -->
<link rel="import" href="/public/lib/iron-icons/iron-icons.html">
<link rel="import" href="/public/lib/paper-icon-button/paper-icon-button.html">
<!-- Web Component -->
<link rel="import" href="/public/lib/iron-ajax/iron-ajax.html">
<link rel="import" href="/public/lib/iron-form/iron-form.html">
<link rel="import" href="/public/lib/paper-input/paper-input.html">
<link rel="import" href="/public/lib/paper-button/paper-button.html">
<link rel="import" href="/public/lib/paper-radio-group/paper-radio-group.html">
<link rel="import" href="/public/lib/paper-radio-button/paper-radio-button.html">

<link rel="import" href="/components/main-layout.html">
<link rel="import" href="/components/image-upload.html">
<dom-module id="signup-page">
  <template>
    <form is="iron-form" id="form" method="post" action="/api/signup" on-iron-form-presubmit="_presubmit">
      <image-upload image="[[user.picture]]" alt="User profile" name="picture"></image-upload>
      <paper-input name="name" label="Name" value="[[user.name]]" required></paper-input>
      <paper-input name="email" label="E-mail" value="[[user.email]]" required></paper-input>
      <label id="gender">Gender:</label>
      <paper-radio-group aria-labelledby="gender" name="gender" attr-for-selected="value" selected="{{gender}}">
        <paper-radio-button name="Male" value="Male">Male</paper-radio-button>
        <paper-radio-button name="Female" value="Female">Female</paper-radio-button>
      </paper-radio-group>
      <paper-input name="age" label="Age" value="[[user.age]]" required></paper-input>

      <input name="accessToken" type="hidden" value="[[user.accessToken]]" required></input>
      <input name="tokens[0].kind" type="hidden" value="[[user.kind]]" required></input>
      <input name="tokens[0].accessToken" type="hidden" value="[[user.accessToken]]" required></input>
      <input name="facebook" type="hidden" value="[[user.facebook]]" required></input>
      <paper-button raised onclick="_delayedSubmit(event)" id="signUpButton">
        <paper-spinner id="spinner" hidden></paper-spinner>Submit</paper-button>
      <paper-button raised onclick="_reset(event)">Reset</paper-button>
      <div class="output"></div>
    </form>
  </template>
  <script>
    Polymer({
      is: 'signup-page',
      properties: {
        user: {
          type: Object,
        }
      },
      _delayedSubmit: function(event) {
        spinner.active = true;
        spinner.hidden = false;
        form.disabled = true;
        // Simulate a slow server response.
        setTimeout(function() {
          this.$.form.submit();
        }, 1000);
      },
      _reset: function(event) {
        var form = Polymer.dom(event).localTarget.parentElement
        form.reset();
        form.querySelector('.output').innerHTML = '';
      },
      _presubmit: function(event) {
        this.$.request.body.gender = app.gender;
      },
      _submit: function(event) {
        spinner.active = false;
        spinner.hidden = true;
        signUpButton.disabled = false;
        this.querySelector('.output').innerHTML = JSON.stringify(event.detail);
      }
    });
  </script>
</dom-module>